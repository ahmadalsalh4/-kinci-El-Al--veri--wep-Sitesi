<script>

    logout();
    login();
    fetchProtectedData();
    
async function login() {
  const response = await fetch('http://localhost:5000/authenticat/login', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ email: 'a12@example.com', password: '123321' }),
  });
  const data = await response.json();
  if (data.token) {
    localStorage.setItem('authToken', data.token);
    alert('Login successful! Token saved.');
  } else {
    alert('Login failed!');
  }
}

async function logout() {
    localStorage.removeItem('authToken');
    alert('Logged out!');
}

async function fetchProtectedData() {
  const token = localStorage.getItem('authToken');

  if (!token) {
    alert('No token found. Login first!');
    return;
  }

  const response = await fetch('http://localhost:5000/me', {
    method: 'GET',
    headers: { 'Authorization': `Bearer ${token}` }
  });

  const data = await response.json();
  if(data.error)
    console.log(error);
  else
    console.log(data.id);

}

</script>